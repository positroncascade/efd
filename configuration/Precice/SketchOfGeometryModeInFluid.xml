<?xml version = "1.0"?>

<precice-configuration>

  <log-filter
    component = ""
    target = "info"
    switch = "on"/>
  <log-filter
    component = "precice"
    target = "debug"
    switch = "off"/>

  <solver-interface
    dimensions = "2"
    geometry-mode = "1"
    restart-mode = "0">

    <!--
    <data:scalar name = "Pressure"/>
     -->

    <data:vector name = "Velocities"/>
    <data:vector name = "Forces"/>

    <mesh name = "Body" flip-normals = "0">
      <use-data name = "Velocities"/>
      <use-data name = "Forces"/>
    </mesh>

    <mesh name = "FluidMesh" flip-normals = "0">
      <use-data name = "Velocities"/>
      <use-data name = "Forces"/>
    </mesh>


    <geometry:builtin-sphere of-mesh = "Body">
      <discretization-width value = "0.001"/>
      <radius value = "0.05"/>
      <offset value = "0.2; 0.2"/>
    </geometry:builtin-sphere>

    <!-- TAG spacetree:dynamic-octree
         (can occur 0..* times)
         ATTR max-meshwidth:
         ATTR name:
         ATTR halflength:
         ATTR offset:  -->
    <!--
    <spacetree:dynamic-octree
      max-meshwidth = "{float}"
      name = "SpaceTreeName"
      halflength = "{vector}"
      offset = "0, 0, 0"/>
      -->

    <!-- TAG spacetree:static-octree
         (can occur 0..* times)
         ATTR max-meshwidth:
         ATTR name:
         ATTR halflength:
         ATTR offset:  -->
    <!--
    <spacetree:static-octree
      max-meshwidth = "{float}"
      name = "{string}"
      halflength = "{vector}"
      offset = "0, 0, 0"/>
      -->

    <!-- TAG participant Represents one solver using preCICE. In a coupled
         simulation, two participants have to be defined, while in geometry
         mode (see tag <solver-interface>) only one participant is necessary.
         (can occur 1..* times)
         ATTR name: Name of the participant. Has to match the name given on
         construction of the precice::SolverInterface object used by the
         participant. -->
    <participant name = "Fluid">

      <mapping:rbf-thin-plate-splines
        constraint = "consistent"
        direction = "write"
        from = "FluidMesh"
        to = "Body"
        timing = "ondemand"/>

      <mapping:rbf-thin-plate-splines
        constraint = "consistent"
        direction = "read"
        from = "Body"
        to = "FluidMesh"
        timing = "ondemand"/>

      <!-- TAG write-data Sets data to be written by the participant to
           preCICE. Data is defined by using the <data> tag.
           (can occur 0..* times)
           ATTR mesh: Mesh the data belongs to. If data should be read/written
           to several meshes, this has to be specified separately for each
           mesh.
           ATTR name: Name of the data. -->
      <write-data mesh = "FluidMesh" name = "Velocities"/>
      <write-data mesh = "Body" name = "Forces"/>

      <!-- TAG read-data Sets data to be read by the participant from preCICE.
           Data is defined by using the <data> tag.
           (can occur 0..* times)
           ATTR mesh: Mesh the data belongs to. If data should be read/written
           to several meshes, this has to be specified separately for each
           mesh.
           ATTR name: Name of the data. -->
      <read-data mesh = "FluidMesh" name = "Forces"/>
      <read-data mesh = "Body" name = "Velocities"/>

      <!-- TAG use-mesh Makes a mesh (see tag <mesh>) available to a
           participant.
           (can occur 0..* times)
           ATTR from: A mesh might not be constructed by a geometry (see tags
           <geometry:...>), but by a solver directly. If a solver created mesh
           should be used by another solver, this attribute has to specify the
           creating participant's name. The creator has to use the attribute
           "provide" to signal he is providing the mesh geometry.
           ATTR name: Name of the mesh.
           ATTR provide: A mesh might not be constructed by a geometry (see
           tags<geometry:...>), but by a solver directly. If this attribute is
           set to "on", the participant has to create the mesh geometry before
           initializing preCICE.
           ATTR offset: The mesh can have an offset only applied for the local
           participant. -->
      <use-mesh name = "FluidMesh" provide = "1" offset = "0; 0; 0"/>
      <use-mesh name = "Body" provide = "0" offset = "0; 0; 0"/>

      <!-- TAG server:sockets When a solver runs in parallel, it has to use
           preCICE in form of a separatly running server. This is enabled by
           this tag. The communication between participant and server is done
           by sockets.
           (can occur 0..1 times)
           ATTR port: Port number to be used by server for socket communiation.
           ATTR exchange-directory: Directory where connection information is
           exchanged. By default, the directory of startup is chosen, and both
           solvers have to be started in the same directory.
           ATTR network: Network name to be used for socket communiation.
           Default is "lo", i.e., the local host loopback. -->
      <!--
      <server:sockets
        port = "{integer}(default:'51235')"
        exchange-directory = "{string}(default:'')"
        network = "{string}(default:'lo')"/>
        -->

      <!-- TAG server:mpi When a solver runs in parallel, it has to use preCICE
           in form of a separatly running server. This is enabled by this tag.
           The communication between participant and server is done by mpi with
           startup in separated communication spaces.
           (can occur 0..1 times)
           ATTR exchange-directory: Directory where connection information is
           exchanged. By default, the directory of startup is chosen, and both
           solvers have to be started in the same directory. -->
      <!--
      <server:mpi exchange-directory = "{string}(default:'')"/>
        -->

      <!-- TAG server:mpi-single When a solver runs in parallel, it has to use
           preCICE in form of a separatly running server. This is enabled by
           this tag. The communication between participant and server is done
           by mpi with startup in a common communication space.
           (can occur 0..1 times) -->
      <!--
      <server:mpi-single/>
        -->
    </participant>
  </solver-interface>
</precice-configuration>



